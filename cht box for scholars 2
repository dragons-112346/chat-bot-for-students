<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Math Tutor Game</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #8ec5fc, #e0c3fc);
}

nav {
  display: flex;
  justify-content: space-around;
  background: #4a69bd;
  padding: 10px;
  color: white;
}

nav button {
  background: white;
  border: none;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
}

.page {
  display: none;
  padding: 15px;
}

.page.active {
  display: block;
}

#chat {
  height: 300px;
  overflow-y: auto;
  background: white;
  padding: 10px;
  border-radius: 10px;
}

.bot {
  background: #eef3ff;
  padding: 8px;
  margin: 5px 0;
  border-radius: 8px;
}

.user {
  background: #d1f7c4;
  padding: 8px;
  margin: 5px 0;
  border-radius: 8px;
  text-align: right;
}

#inputArea {
  display: flex;
  margin-top: 8px;
}

input {
  flex: 1;
  padding: 8px;
}

button.send {
  padding: 8px;
}

.avatar {
  font-size: 50px;
}

.shop-item {
  background: white;
  padding: 10px;
  border-radius: 10px;
  margin: 5px 0;
}
</style>
</head>

<body>

<nav>
  <button onclick="showPage('home')">Home</button>
  <button onclick="showPage('chatPage')">Chat</button>
  <button onclick="showPage('shop')">Shop</button>
  <button onclick="showPage('limits')">Limits</button>
</nav>

<!-- HOME -->
<div id="home" class="page active">
  <h2>ğŸ  Welcome</h2>
  <p>Choose your tutor:</p>
  <button onclick="setAvatar('ğŸ‘¦')">Boy Tutor</button>
  <button onclick="setAvatar('ğŸ‘§')">Girl Tutor</button>
  <p id="coins">ğŸŸ¡ Coins: 0</p>
</div>

<!-- CHAT -->
<div id="chatPage" class="page">
  <div class="avatar" id="avatar">ğŸ‘¦</div>
  <div id="chat"></div>

  <div id="inputArea">
    <input id="input" placeholder="Type a math problem (ex: 3x + 2 = 8)">
    <button class="send" onclick="send()">Send</button>
  </div>
</div>

<!-- SHOP -->
<div id="shop" class="page">
  <h2>ğŸ›ï¸ Shop (Always Open)</h2>
  <div class="shop-item">ğŸ© Hat â€“ 20 ğŸŸ¡</div>
  <div class="shop-item">ğŸ‘• Shirt â€“ 30 ğŸŸ¡</div>
  <div class="shop-item">âœ¨ Cool Outfit â€“ 50 ğŸŸ¡</div>
</div>

<!-- LIMITS -->
<div id="limits" class="page">
  <h2>âŒ What I Canâ€™t Do</h2>
  <ul>
    <li>I canâ€™t do homework for you</li>
    <li>I canâ€™t skip steps</li>
    <li>I canâ€™t answer non-school questions</li>
    <li>I only help with Kâ€“12 math</li>
  </ul>
</div>

<script>
let coins = 0;
let mode = "idle";
let step = 0;
let a, b, op, variable = "x";

function showPage(id) {
  document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function setAvatar(a) {
  document.getElementById("avatar").textContent = a;
}

function addMessage(text, who) {
  const chat = document.getElementById("chat");
  const div = document.createElement("div");
  div.className = who;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function updateCoins(n) {
  coins += n;
  document.getElementById("coins").textContent = "ğŸŸ¡ Coins: " + coins;
}

function send() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text) return;

  addMessage(text, "user");
  input.value = "";
  handle(text);
}

function handle(t) {
  // detect variable
  const match = t.match(/[a-zA-Z]/);
  if (match) variable = match[0];

  // simple math detect
  if (mode === "idle" && t.match(/[\+\-\*\/]/)) {
    const parts = t.split(/[\+\-\*\/]/);
    a = Number(parts[0].replace(variable,"").trim()) || 1;
    b = Number(parts[1].trim());
    op = t.match(/[\+\-\*\/]/)[0];

    mode = "teach";
    step = 1;

    addMessage(`ğŸ“˜ Letâ€™s solve step by step with variable ${variable}`, "bot");
    addMessage(`Step 1: What operation is this?`, "bot");
    return;
  }

  if (mode === "teach" && step === 1) {
    if (t.includes(op)) {
      step = 2;
      addMessage("âœ… Correct!", "bot");
      addMessage(`Step 2: Perform the operation.`, "bot");
      return;
    }
    addMessage("âŒ Look at the symbol.", "bot");
    return;
  }

  if (mode === "teach" && step === 2) {
    addMessage("ğŸ‰ Nice work!", "bot");
    addMessage("ğŸ† Lesson complete!", "bot");
    updateCoins(5);
    mode = "idle";
    return;
  }

  addMessage("ğŸ¤” I didnâ€™t understand. Try a math problem.", "bot");
}

addMessage("ğŸ‘‹ Hi! Paste a math problem to start.", "bot");
</script>

</body>
</html>
